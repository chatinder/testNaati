<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Naati With Singh CCL Punjabi Dialogues</title>
    <style>
        body { display: flex; align-items: center; justify-content: center; height: 100vh; font-family: Arial, sans-serif; }
        .container { text-align: center; max-width: 500px; display: none; }
        .notice { font-size: 0.9em; color: gray; }
        .lesson { margin-top: 20px; }
        .lesson h2 { font-size: 1.2em; color: #333; }
        .audio-buttons { display: flex; flex-direction: column; gap: 10px; }
        button { padding: 10px 20px; font-size: 1em; cursor: pointer; }
        .custom-audio-controls { margin-top: 20px; }
    </style>
</head>
<body>
    <div class="container" id="contentContainer">
        <h1>Naati With Singh CCL Punjabi Dialogues</h1>
        <p class="notice">This audio is for listening only. Downloading and sharing are restricted.</p>
        
        <!-- Finance Section -->
        <div class="lesson">
            <h2>Finance</h2>
            <div class="audio-buttons">
                <button onclick="loadAndPlayAudio('finance/P25_financial.mp3')">Finance - Audio 1</button>
                <button onclick="loadAndPlayAudio('finance/P38_financial.mp3')">Finance - Audio 2</button>
            </div>
        </div>
        
        <!-- Housing Section -->
        <div class="lesson">
            <h2>Housing</h2>
            <div class="audio-buttons">
                <button onclick="loadAndPlayAudio('housing/P5_housing.mp3')">Housing - Audio 1</button>
                <button onclick="loadAndPlayAudio('housing/P30_housing.mp3')">Housing - Audio 2</button>
                <button onclick="loadAndPlayAudio('housing/housing.mp3')">Housing - Audio 3</button>
            </div>
        </div>

        <!-- Single Play/Pause button for the currently selected audio -->
        <div class="custom-audio-controls">
            <button id="playPauseButton">Play/Pause</button>
        </div>
    </div>

    <!-- Google Sign-In button -->
    <button id="googleSignInButton">Sign In with Google</button>

    <script type="module">
      // Import the necessary Firebase functions
      import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
      import { getAuth, GoogleAuthProvider, signInWithPopup, signOut } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-auth.js";
      import { getAnalytics } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-analytics.js";

      // Firebase configuration
      const firebaseConfig = {
        apiKey: "AIzaSyBYWlvGwv4RCHMhbX1ABHeaW86qVTYq_mM",
        authDomain: "naatiwithsingh-eaea5.firebaseapp.com",
        projectId: "naatiwithsingh-eaea5",
        storageBucket: "naatiwithsingh-eaea5.firebasestorage.app",
        messagingSenderId: "630043652454",
        appId: "1:630043652454:web:717958c7a689ce774718a7",
        measurementId: "G-N5RV8HFQ1W"
      };

      // Initialize Firebase
      const app = initializeApp(firebaseConfig);
      const auth = getAuth(app);
      const analytics = getAnalytics(app);

      // Predefined allowed email
      const allowedEmail = "naatiwithsingh@gmail.com";

      // Get the content container and sign-in button
      const contentContainer = document.getElementById("contentContainer");
      const googleSignInButton = document.getElementById("googleSignInButton");

      // Google Sign-In function
      googleSignInButton.addEventListener("click", async () => {
        const provider = new GoogleAuthProvider();

        try {
          const result = await signInWithPopup(auth, provider);
          const user = result.user;
          const userEmail = user.email;

          if (userEmail === allowedEmail) {
            contentContainer.style.display = "block"; // Show content for allowed email
            googleSignInButton.style.display = "none"; // Hide sign-in button after success
          } else {
            alert("Access Denied: Unauthorized Email");
            signOut(auth); // Log out the user if email is not allowed
          }
        } catch (error) {
          console.error("Error during sign-in:", error);
          alert("Authentication failed. Please try again.");
        }
      });

      // Function to load and play the selected audio
      let audioPlayer;
      const playPauseButton = document.getElementById('playPauseButton');

      function loadAndPlayAudio(filePath) {
        if (audioPlayer) {
          audioPlayer.pause(); // Stop any currently playing audio
        }
        audioPlayer = new Audio(filePath); // Load the selected audio file
        audioPlayer.play(); // Automatically start playing it
        playPauseButton.textContent = 'Pause'; // Update button to show "Pause" status
        audioPlayer.onended = () => {
          playPauseButton.textContent = 'Play';
        };
      }

      // Play/Pause control for the currently loaded audio
      playPauseButton.addEventListener('click', () => {
        if (audioPlayer) {
          if (audioPlayer.paused) {
            audioPlayer.play();
            playPauseButton.textContent = 'Pause';
          } else {
            audioPlayer.pause();
            playPauseButton.textContent = 'Play';
          }
        } else {
          alert("Please select an audio file first.");
        }
      });

      // Disable right-click and shortcuts to prevent downloading
      document.addEventListener('contextmenu', event => event.preventDefault());
      document.addEventListener('keydown', function(event) {
        if (event.ctrlKey && (event.key === 's' || event.key === 'p')) {
          event.preventDefault();
          alert("Downloading is disabled on this page.");
        }
      });
    </script>
</body>
</html>
